---
layout: post
title: 呷爸 jaba - AI 午餐訂便當系統
---

![jaba]({{ site.baseurl }}/images/jaba/jaba-icon-32.png) [呷爸 jaba](https://github.com/yazelin/jaba) 是一個 AI 驅動的午餐訂便當系統，用自然語言輕鬆訂餐！

專為團隊設計的午餐訂便當平台，只需告訴 AI 想吃什麼，系統就會自動處理訂單。

---

### 功能特色

**使用者功能**：
- AI 對話訂餐 - 用自然語言與 AI 互動（例如：「我要點雞腿便當」）
- 快速點餐 - 直接點擊菜單項目加入訂單
- 多店家選擇 - 支援當天多家店家
- 特價優惠自動套用 - 買一送一、第二杯折扣、限時特價
- 卡路里估算 - AI 自動估算每道餐點的熱量
- 個人偏好記錄 - 記住飲食偏好和過敏資訊

**管理員功能**：
- 店家管理 - 新增、編輯、啟用/停用店家
- 菜單圖片辨識 - 上傳菜單圖片，AI 自動提取
- 差異預覽 - 顯示新增/修改/刪除的項目
- 訂單總覽與統計 - 即時查看所有訂單
- 付款追蹤 - 標記付款狀態和處理退款

**系統功能**：
- 即時同步 - Socket.IO 廣播訂單與狀態變更
- 瀏覽器通知 - 新訂單、訊息即時推播
- 團體聊天室 - 內建即時通訊方便同事溝通

---

### 系統架構

![系統架構]({{ site.baseurl }}/images/jaba/system-architecture.jpg)

---

### 技術棧

| 技術 | 用途 |
|------|------|
| FastAPI | Web 框架 |
| Socket.IO | 即時通訊 |
| Claude / Gemini | AI 對話與菜單辨識 |
| Jinja2 | 模板引擎 |
| JSON 檔案 | 資料儲存（無資料庫） |
| uv | 套件管理 |

---

### 三個主頁面

| 頁面 | 路徑 | 功能 |
|------|------|------|
| 看板頁 | `/` | 今日訂單總覽、訂單統計 |
| 訂餐頁 | `/order` | AI 對話訂餐、快速點餐 |
| 管理頁 | `/manager` | 店家菜單管理、付款追蹤 |

**訂餐頁面**：

![訂餐對話]({{ site.baseurl }}/images/jaba/01-order-page-chat.jpg)

**看板頁面**：

![看板頁面]({{ site.baseurl }}/images/jaba/03-dashboard-summary.jpg)

**管理頁面**：

![管理頁面]({{ site.baseurl }}/images/jaba/02-manager-page-overview.jpg)

---

### AI 功能亮點

**分層 Prompt 架構**：
```
Layer 4: 當前訊息
Layer 3: 對話歷史（最近 20 條）
Layer 2: 動態上下文（今日店家、菜單、使用者偏好、目前訂單）
Layer 1: 系統提示詞
```

**AI 可執行的動作**：
- `create_order` - 建立新訂單
- `update_order` - 更新訂單
- `cancel_order` - 取消訂單
- `remove_item` - 從訂單移除品項
- `set_today_store` - 設定今日店家
- `update_menu` - 更新菜單

**支援多個 AI Provider**：
- Claude CLI (haiku, sonnet, opus)
- Gemini CLI (gemini-2.5-flash-lite, gemini-2.5-pro)

---

### 菜單辨識

上傳菜單圖片，AI 自動提取結構化資訊：
- 識別品項名稱和價格
- 識別促銷標記（買一送一、第二杯折扣）
- 識別尺寸變體（大杯/中杯）
- 差異預覽後選擇性應用變更

---

### 專案結構

```
jaba/
├── main.py                  # FastAPI 應用程式入口
├── app/
│   ├── ai.py                # AI 整合主模組
│   ├── data.py              # 資料存取層
│   └── providers/           # AI Provider 模組
│       ├── claude.py        # Claude CLI 實作
│       └── gemini.py        # Gemini CLI 實作
├── data/
│   ├── stores/              # 店家資料與菜單
│   ├── orders/              # 每日訂單彙整
│   ├── users/               # 使用者資料
│   └── system/              # 系統設定與 AI 提示詞
├── templates/               # HTML 頁面
└── static/                  # 靜態資源
```

---

### 快速開始

```bash
# 安裝相依套件
uv sync

# 設定 API 金鑰
export ANTHROPIC_API_KEY="your-api-key"

# 啟動伺服器
uv run uvicorn main:socket_app --reload --host 0.0.0.0 --port 8098

# 開啟瀏覽器
# http://localhost:8098
```

---

### GitHub

[https://github.com/yazelin/jaba](https://github.com/yazelin/jaba)
